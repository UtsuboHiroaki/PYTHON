# モジュール、オブジェクトのインポート

## モジュールのインポート

インポートとは、別のファイルに定義されたモジュールやオブジェクトを利用可能にする手続き。    
インポートは、以下のいずれかの方法でできる。

- import 文を使う
- import_module 関数を使う

後者は、インポート対象をプログラム実行開始後に動的に決定したい場合に使う。(*)  
import_module を使う場合の挙動を分解すると、以下のとおり。

1. 利用したいプログラムを設定ファイル内に記述しておく
2. プログラムは、実行開始すると、設定ファイルを読み込む
3. 設定ファイルの内容に従って、インポート対象を決定する
4. import_module 関数を使って、インポート対象をインポートする

(*) エクセルVBAから学習を進めてきた方によくある戸惑いのひとつは、「オブジェクトを文字列ベースで指定する方法がある」ということ

***

## モジュールとパッケージ

モジュールとは、変数、定数、関数やクラスなどのオブジェクトをひとつのファイルにまとめて定義したもの。  
パッケージとは、複数モジュールをまとめたひとつのディレクトリ。  
パッケージは、 __init__.py というファイルを必ず含む。

なお、モジュールのインポートの場合は、モジュール内の _ ではじまる名前のオブジェクトは利用できないので注意。

この機会に、Python での一般的なネーミングルールを以下に示す。

| 名前            | 説明 |
|---------------|---|
| モジュール名、パッケージ名 | snake case で記述する |
| 変数名           | snake case で記述する |
| 定数名           | 全て大文字で記述する |
| 関数名           | snake case で記述する |
| クラス名          | CamelCase で記述する |

- [snake case](https://forum.pc5bai.com/tips/glossary/snake_case/)
- [CamelCase](https://forum.pc5bai.com/tips/glossary/camel_case/)

変数、定数、関数では、その名称の先頭に _ を1つまたは2つつけることがある。

| パターン  | ニュアンス                                              | 例                   | 
|-------|----------------------------------------------------|---------------------|
| 1つの場合 | 「外部から直接呼び出されない、呼び出してはいけない」というニュアンスになる。             | _get_inner_file()   | 
| 2つの場合 | オブジェクトの挙動に影響を与える、定義済のメソッド/定数というニュアンス。<br>自作はしないこと。 | __div__(), __name__ | 

## __all__, __file__ , __name__

### 変数 __all__

__all__ がある場合、モジュールのインポート時、 __all__ 内で指定されたオブジェクト以外は、インポートされない。  
(自分で実装することはまずないが、ある程度の規模のパッケージでは見かけることがある)

### 変数 __file__

__file__ は、モジュールの絶対パスを文字列で返す。
pathlib.Path 等でのパス生成時に使う。

### 変数 __name__

__name__ は、そのモジュールが直接実行された場合は、 '__main__' を返す。
逆に言うと、import文で呼び出されたときには、 '__main__' を返さない。  
この性質を活かして、「直接このモジュールが実行されたときだけ、処理をする」という趣旨で、以下のような条件分岐を使う。

```python
if __name__ == '__main__':
    # 直接このモジュールが実行されたときだけ実行したい処理を記入
    print('このモジュールが直接実行されました')

```

モジュールに記載された処理は、 import 文を実行しただけで自動的に実行されてしまうので注意！

一方、副作用のある処理などは、 import されただけで実行されてしまうのは不都合。    
ということで、必要に応じて、この条件分岐によって、 import しただけで処理が自動的にされてしまうのを回避する。

## そのほか:

module と package で同名のものがあると不具合が起きるので、注意。  
(Pythonあるあるです)

